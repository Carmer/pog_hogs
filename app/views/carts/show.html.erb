<h1 class="center">Your Cart</h1>

<div class="cart_list">
  <table style="width:100%">
    <tr>
      <th>Item</th>
      <th>Description</th>
      <th>Price</th>
      <th>Quantity</th>
      <th>Subtotal</th>
      <th>Update Quantity</th>
    </tr>

  <% if @cart_items.empty? %>
        <%= link_to "Your Cart is Empty - Click to Keep Shopping", items_path %>
  <% else %>
  <% @cart_items.each do |item| %>
      <div class="cart_item">
        <tr>
          <td><%= item.title %>
              <div class="img-thumbnail"><%= link_to image_tag(item.image_path), category_item_path(item.category, item) %></td></div><br>
          <td><%= item.description %></td>
          <td><%= item.price  %></td>
          <td><%= item.quantity %></td>
          <td><%= item.subtotal.round(2) %></td>
            <%= form_tag('/cart', id: item.id, method: :put) do %>

                  <td><%= hidden_field_tag :id, "#{item.id}" %>
                      <%= text_field_tag :update %>
                      <%=  submit_tag 'Update Quantity' %></td>

            <% end %>
          <td> <%= button_to "Remove", '/cart', method: :delete, params: {id: item.id} %></td>
          <% end %>
        </tr>
      </div>
  <% end %>
  </table>
</div>

<div class="total right">
  <h4>Total: $<%= @cart.total %><br></h4>
<%- unless current_user == nil -%>
  <%= button_to "Proceed to checkout", orders_path, method: :post %>
<%- else -%>
  <%= button_to "Log In to Checkout", login_path, method: :get  %>
  <small><%= link_to "Create Account", new_user_path %></small>
  <%- end -%>
</div>
